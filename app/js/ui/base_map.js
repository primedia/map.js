'use strict';
define(['jquery', 'flight/lib/component', '../utils/map_utils', '../utils/distance_conversion'], function($, defineComponent, mapUtils, distanceConversion) {
  var defaultMap;
  defaultMap = function() {
    this.defaultAttrs({
      latitude: 33.9411,
      longitude: -84.2136,
      gMap: {},
      gMapEvents: {
        'center_changed': false,
        'zoom_changed': false
      },
      infoWindowOpen: false,
      overlay: void 0,
      draggable: true,
      geoData: {},
      gMapOptions: {
        draggable: void 0
      }
    });
    this.data = {};
    this.after('initialize', function() {
      this.on(document, 'mapDataAvailable', this.initBaseMap);
      this.on(document, 'mapRendered', this.consolidateMapChangeEvents);
      return this.on(document, 'uiInfoWindowDataRequest', (function(_this) {
        return function() {
          return _this.attr.infoWindowOpen = true;
        };
      })(this));
    });
    this.initBaseMap = function(ev, data) {
      this.data = data || {};
      return this.firstRender();
    };
    this.consolidateMapChangeEvents = function(ev, data) {
      google.maps.event.addListenerOnce(data.gMap, 'zoom_changed', (function(_this) {
        return function() {
          return _this.trigger(document, 'uiMapZoom', _this.mapChangedData());
        };
      })(this));
      return google.maps.event.addListenerOnce(data.gMap, 'dragend', (function(_this) {
        return function() {
          return _this.trigger(document, 'uiMapDrag', _this.mapChangedData());
        };
      })(this));
    };
    this.intervalId = null;
    this.firstRender = function() {
      google.maps.visualRefresh = true;
      this.attr.gMap = new google.maps.Map(this.node, this.defineGoogleMapOptions());
      google.maps.event.addListenerOnce(this.attr.gMap, 'idle', (function(_this) {
        return function() {
          _this.fireOurMapEventsOnce();
          return _this.handleOurMapEvents();
        };
      })(this));
      return this.addCustomMarker();
    };
    this.fireOurMapEventsOnce = function() {
      clearInterval(this.intervalId);
      this.trigger(document, 'mapRenderedFirst', this.mapRenderedFirstData());
      this.trigger(document, 'mapRendered', this.mapRenderedFirstData());
      this.trigger(document, 'uiInitMarkerCluster', this.mapChangedData());
      return this.trigger(document, "uiNeighborhoodDataRequest", this.mapChangedDataBase());
    };
    this.handleOurMapEvents = function(event_type) {
      google.maps.event.addListener(this.attr.gMap, 'zoom_changed', (function(_this) {
        return function() {
          return _this.storeEvent('zoom_changed');
        };
      })(this));
      google.maps.event.addListener(this.attr.gMap, 'center_changed', (function(_this) {
        return function() {
          return _this.storeEvent('center_changed');
        };
      })(this));
      return google.maps.event.addListener(this.attr.gMap, 'idle', (function(_this) {
        return function() {
          return _this.fireOurMapEvents();
        };
      })(this));
    };
    this.storeEvent = function(event) {
      return this.attr.gMapEvents[event] = true;
    };
    this.fireOurMapEvents = function() {
      var eventsHash;
      eventsHash = this.attr.gMapEvents;
      if (this.attr.infoWindowOpen === true) {
        eventsHash['center_changed'] = false;
      }
      clearInterval(this.intervalId);
      if (eventsHash['center_changed']) {
        this.trigger(document, 'uiMapZoomForListings', this.mapChangedData());
        this.trigger(document, 'uiInitMarkerCluster', this.mapChangedData());
        this.trigger(document, 'mapRendered', this.mapChangedData());
        this.trigger(document, 'uiNeighborhoodDataRequest', this.mapChangedDataBase());
      }
      return this.resetOurEventHash();
    };
    this.resetOurEventHash = function() {
      this.attr.gMapEvents['zoom_changed'] = false;
      this.attr.gMapEvents['center_changed'] = false;
      return this.attr.infoWindowOpen = false;
    };
    this.defineGoogleMapOptions = function() {
      var geo, k, options, ref, v;
      geo = this.getInitialGeo();
      options = {
        center: new google.maps.LatLng(geo.lat, geo.lng),
        zoom: this.radiusToZoom(this.geoDataRadiusMiles()),
        mapTypeId: google.maps.MapTypeId.ROADMAP,
        scaleControl: true
      };
      ref = this.attr.gMapOptions;
      for (k in ref) {
        v = ref[k];
        options[k] = v;
      }
      return options;
    };
    this.radiusToZoom = function(radius) {
      if (radius == null) {
        radius = 10;
      }
      return Math.round(14 - Math.log(radius) / Math.LN2) + 1;
    };
    this.latitude = function() {
      return this.attr.latitude = this.mapCenter().lat();
    };
    this.longitude = function() {
      return this.attr.longitude = this.mapCenter().lng();
    };
    this.southWestLatitude = function() {
      return this.attr.gMap.getBounds().getSouthWest().lat();
    };
    this.southWestLongitude = function() {
      return this.attr.gMap.getBounds().getSouthWest().lng();
    };
    this.northEastLatitude = function() {
      return this.attr.gMap.getBounds().getNorthEast().lat();
    };
    this.northEastLongitude = function() {
      return this.attr.gMap.getBounds().getNorthEast().lng();
    };
    this.radius = function() {
      var gBounds, latitudinalDistance, longitudinalDistance, radiusInMeters, south, southWest, west;
      gBounds = this.attr.gMap.getBounds();
      southWest = gBounds.getSouthWest();
      west = new google.maps.LatLng(this.latitude(), southWest.lng());
      south = new google.maps.LatLng(southWest.lat(), this.longitude());
      longitudinalDistance = google.maps.geometry.spherical.computeDistanceBetween(west, this.mapCenter());
      latitudinalDistance = google.maps.geometry.spherical.computeDistanceBetween(south, this.mapCenter());
      return radiusInMeters = Math.max(longitudinalDistance, latitudinalDistance);
    };
    this.mapCenter = function() {
      var gLatLng;
      return gLatLng = this.attr.gMap.getCenter();
    };
    this.addCustomMarker = function() {
      return this.customMarkerDialogClose();
    };
    this.customMarkerDialogClose = function() {
      return $('#pin_search_controls a.icon_close').click((function(_this) {
        return function() {
          return $('#pin_search_controls').remove();
        };
      })(this));
    };
    this.mapRenderedFirstData = function() {
      var data;
      data = this.mapChangedData();
      data.zip = this.geoData().zip;
      data.city = this.geoData().city;
      data.state = this.geoData().state;
      data.hood = this.geoData().hood;
      return data;
    };
    this.mapChangedData = function() {
      var data;
      data = this.mapChangedDataBase();
      data.sort = 'distance';
      return data;
    };
    this.mapChangedDataBase = function() {
      return {
        gMap: this.attr.gMap,
        latitude: mapUtils.limitScaleOf(this.latitude()),
        longitude: mapUtils.limitScaleOf(this.longitude()),
        radius: this.radius(),
        lat1: mapUtils.limitScaleOf(this.southWestLatitude()),
        lng1: mapUtils.limitScaleOf(this.southWestLongitude()),
        lat2: mapUtils.limitScaleOf(this.northEastLatitude()),
        lng2: mapUtils.limitScaleOf(this.northEastLongitude()),
        zip: this.geoData().zip,
        city: this.geoData().city,
        state: this.geoData().state,
        hood: this.geoData().hood,
        hoodDisplayName: this.geoData().hood_display_name
      };
    };
    this.zoomCircle = function() {
      var circle, circleOptions, radius;
      radius = distanceConversion.convertMilesToMeters(this.geoDataRadiusMiles());
      circleOptions = {
        center: this.mapCenter(),
        map: this.attr.gMap,
        radius: radius,
        fillOpacity: 0.0,
        strokeOpacity: 0.0
      };
      return circle = new google.maps.Circle(circleOptions);
    };
    this.geoDataRadiusMiles = function() {
      return this.geoData().rad || 10;
    };
    this.geoData = function() {
      return this.attr.geoData || {};
    };
    return this.getInitialGeo = function() {
      return {
        lat: this.data.lat || this.data.latitude || this.attr.latitude,
        lng: this.data.lng || this.data.longitude || this.attr.longitude
      };
    };
  };
  return defineComponent(defaultMap);
});

//# sourceMappingURL=data:application/json;base64,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OlsiJ3VzZSBzdHJpY3QnXG5cbmRlZmluZSBbXG4gICdqcXVlcnknXG4gICdmbGlnaHQvbGliL2NvbXBvbmVudCdcbiAgJy4uL3V0aWxzL21hcF91dGlscydcbiAgJy4uL3V0aWxzL2Rpc3RhbmNlX2NvbnZlcnNpb24nXG5dLCAoXG4gICRcbiAgZGVmaW5lQ29tcG9uZW50XG4gIG1hcFV0aWxzXG4gIGRpc3RhbmNlQ29udmVyc2lvblxuKSAtPlxuXG4gIGRlZmF1bHRNYXAgPSAtPlxuXG4gICAgQGRlZmF1bHRBdHRyc1xuICAgICAgbGF0aXR1ZGU6IDMzLjk0MTFcbiAgICAgIGxvbmdpdHVkZTogLTg0LjIxMzZcbiAgICAgIGdNYXA6IHt9XG4gICAgICBnTWFwRXZlbnRzOiB7J2NlbnRlcl9jaGFuZ2VkJzogZmFsc2UsICd6b29tX2NoYW5nZWQnOiBmYWxzZX1cbiAgICAgIGluZm9XaW5kb3dPcGVuOiBmYWxzZVxuICAgICAgb3ZlcmxheTogdW5kZWZpbmVkXG4gICAgICBkcmFnZ2FibGU6IHRydWVcbiAgICAgIGdlb0RhdGE6IHt9XG4gICAgICBnTWFwT3B0aW9uczpcbiAgICAgICAgZHJhZ2dhYmxlOiB1bmRlZmluZWRcblxuICAgIEBkYXRhID0ge31cblxuICAgIEBhZnRlciAnaW5pdGlhbGl6ZScsIC0+XG4gICAgICBAb24gZG9jdW1lbnQsICdtYXBEYXRhQXZhaWxhYmxlJywgQGluaXRCYXNlTWFwXG4gICAgICBAb24gZG9jdW1lbnQsICdtYXBSZW5kZXJlZCcsIEBjb25zb2xpZGF0ZU1hcENoYW5nZUV2ZW50c1xuICAgICAgQG9uIGRvY3VtZW50LCAndWlJbmZvV2luZG93RGF0YVJlcXVlc3QnLCA9PlxuICAgICAgICBAYXR0ci5pbmZvV2luZG93T3BlbiA9IHRydWVcblxuICAgIEBpbml0QmFzZU1hcCA9IChldiwgZGF0YSkgLT5cbiAgICAgIEBkYXRhID0gZGF0YSB8fCB7fVxuICAgICAgQGZpcnN0UmVuZGVyKClcblxuICAgIEBjb25zb2xpZGF0ZU1hcENoYW5nZUV2ZW50cyA9IChldiwgZGF0YSkgLT5cbiAgICAgIGdvb2dsZS5tYXBzLmV2ZW50LmFkZExpc3RlbmVyT25jZSBkYXRhLmdNYXAsICd6b29tX2NoYW5nZWQnLCA9PlxuICAgICAgICBAdHJpZ2dlciBkb2N1bWVudCwgJ3VpTWFwWm9vbScsIEBtYXBDaGFuZ2VkRGF0YSgpXG4gICAgICBnb29nbGUubWFwcy5ldmVudC5hZGRMaXN0ZW5lck9uY2UgZGF0YS5nTWFwLCAnZHJhZ2VuZCcsID0+XG4gICAgICAgIEB0cmlnZ2VyIGRvY3VtZW50LCAndWlNYXBEcmFnJywgQG1hcENoYW5nZWREYXRhKClcblxuICAgIEBpbnRlcnZhbElkID0gbnVsbFxuXG4gICAgQGZpcnN0UmVuZGVyID0gLT5cbiAgICAgICMgbmV3IHZlcnNpb24gb2YgZ21hcCBhcGkgMy4xNCBpcyB0aGUgbmV4dCBzdGFibGUgdmVyc2lvblxuICAgICAgIyBpdCBpbmx1ZGVzIHZpc3VhbFJlZnJlc2hcbiAgICAgIGdvb2dsZS5tYXBzLnZpc3VhbFJlZnJlc2ggPSB0cnVlXG5cbiAgICAgIEBhdHRyLmdNYXAgPSBuZXcgZ29vZ2xlLm1hcHMuTWFwKEBub2RlLCBAZGVmaW5lR29vZ2xlTWFwT3B0aW9ucygpKVxuXG4gICAgICBnb29nbGUubWFwcy5ldmVudC5hZGRMaXN0ZW5lck9uY2UgQGF0dHIuZ01hcCwgJ2lkbGUnLCA9PlxuICAgICAgICBAZmlyZU91ck1hcEV2ZW50c09uY2UoKVxuICAgICAgICBAaGFuZGxlT3VyTWFwRXZlbnRzKClcbiAgICAgIEBhZGRDdXN0b21NYXJrZXIoKVxuXG4gICAgQGZpcmVPdXJNYXBFdmVudHNPbmNlID0gKCkgLT5cbiAgICAgIGNsZWFySW50ZXJ2YWwoQGludGVydmFsSWQpXG4gICAgICBAdHJpZ2dlciBkb2N1bWVudCwgJ21hcFJlbmRlcmVkRmlyc3QnLCBAbWFwUmVuZGVyZWRGaXJzdERhdGEoKVxuICAgICAgQHRyaWdnZXIgZG9jdW1lbnQsICdtYXBSZW5kZXJlZCcsICBAbWFwUmVuZGVyZWRGaXJzdERhdGEoKVxuICAgICAgQHRyaWdnZXIgZG9jdW1lbnQsICd1aUluaXRNYXJrZXJDbHVzdGVyJywgQG1hcENoYW5nZWREYXRhKClcbiAgICAgIEB0cmlnZ2VyIGRvY3VtZW50LCBcInVpTmVpZ2hib3Job29kRGF0YVJlcXVlc3RcIiwgQG1hcENoYW5nZWREYXRhQmFzZSgpXG5cblxuICAgIEBoYW5kbGVPdXJNYXBFdmVudHMgPSAoZXZlbnRfdHlwZSkgLT5cbiAgICAgIGdvb2dsZS5tYXBzLmV2ZW50LmFkZExpc3RlbmVyIEBhdHRyLmdNYXAsICd6b29tX2NoYW5nZWQnLCA9PlxuICAgICAgICBAc3RvcmVFdmVudCgnem9vbV9jaGFuZ2VkJylcbiAgICAgIGdvb2dsZS5tYXBzLmV2ZW50LmFkZExpc3RlbmVyIEBhdHRyLmdNYXAsICdjZW50ZXJfY2hhbmdlZCcsID0+XG4gICAgICAgIEBzdG9yZUV2ZW50KCdjZW50ZXJfY2hhbmdlZCcpXG4gICAgICBnb29nbGUubWFwcy5ldmVudC5hZGRMaXN0ZW5lciBAYXR0ci5nTWFwLCAnaWRsZScsID0+XG4gICAgICAgIEBmaXJlT3VyTWFwRXZlbnRzKClcblxuICAgIEBzdG9yZUV2ZW50ID0gKGV2ZW50KSAtPlxuICAgICAgQGF0dHIuZ01hcEV2ZW50c1tldmVudF0gPSB0cnVlXG5cbiAgICBAZmlyZU91ck1hcEV2ZW50cyA9ICgpIC0+XG4gICAgICBldmVudHNIYXNoID0gQGF0dHIuZ01hcEV2ZW50c1xuICAgICAgZXZlbnRzSGFzaFsnY2VudGVyX2NoYW5nZWQnXSA9IGZhbHNlIGlmIEBhdHRyLmluZm9XaW5kb3dPcGVuID09IHRydWVcbiAgICAgIGNsZWFySW50ZXJ2YWwoQGludGVydmFsSWQpXG4gICAgICBpZiBldmVudHNIYXNoWydjZW50ZXJfY2hhbmdlZCddXG4gICAgICAgIEB0cmlnZ2VyIGRvY3VtZW50LCAndWlNYXBab29tRm9yTGlzdGluZ3MnLCBAbWFwQ2hhbmdlZERhdGEoKVxuICAgICAgICBAdHJpZ2dlciBkb2N1bWVudCwgJ3VpSW5pdE1hcmtlckNsdXN0ZXInLCBAbWFwQ2hhbmdlZERhdGEoKVxuICAgICAgICBAdHJpZ2dlciBkb2N1bWVudCwgJ21hcFJlbmRlcmVkJywgQG1hcENoYW5nZWREYXRhKClcbiAgICAgICAgQHRyaWdnZXIgZG9jdW1lbnQsICd1aU5laWdoYm9yaG9vZERhdGFSZXF1ZXN0JywgQG1hcENoYW5nZWREYXRhQmFzZSgpXG5cbiAgICAgIEByZXNldE91ckV2ZW50SGFzaCgpXG5cbiAgICBAcmVzZXRPdXJFdmVudEhhc2ggPSAoKSAtPlxuICAgICAgQGF0dHIuZ01hcEV2ZW50c1snem9vbV9jaGFuZ2VkJ10gPSBmYWxzZVxuICAgICAgQGF0dHIuZ01hcEV2ZW50c1snY2VudGVyX2NoYW5nZWQnXSA9IGZhbHNlXG4gICAgICBAYXR0ci5pbmZvV2luZG93T3BlbiA9IGZhbHNlXG5cbiAgICBAZGVmaW5lR29vZ2xlTWFwT3B0aW9ucyA9ICgpIC0+XG4gICAgICBnZW8gPSBAZ2V0SW5pdGlhbEdlbygpXG4gICAgICBvcHRpb25zID1cbiAgICAgICAgY2VudGVyOiAgICAgICBuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nKGdlby5sYXQsIGdlby5sbmcpXG4gICAgICAgIHpvb206ICAgICAgICAgQHJhZGl1c1RvWm9vbShAZ2VvRGF0YVJhZGl1c01pbGVzKCkpXG4gICAgICAgIG1hcFR5cGVJZDogICAgZ29vZ2xlLm1hcHMuTWFwVHlwZUlkLlJPQURNQVBcbiAgICAgICAgc2NhbGVDb250cm9sOiB0cnVlXG5cbiAgICAgIGZvciBrLCB2IG9mIEBhdHRyLmdNYXBPcHRpb25zXG4gICAgICAgIG9wdGlvbnNba10gPSB2XG5cbiAgICAgIG9wdGlvbnNcblxuICAgIEByYWRpdXNUb1pvb20gPSAocmFkaXVzID0gMTApIC0+XG4gICAgICBNYXRoLnJvdW5kKDE0LU1hdGgubG9nKHJhZGl1cykvTWF0aC5MTjIpICsgMVxuXG4gICAgQGxhdGl0dWRlID0gLT5cbiAgICAgIEBhdHRyLmxhdGl0dWRlID0gQG1hcENlbnRlcigpLmxhdCgpXG5cbiAgICBAbG9uZ2l0dWRlID0gLT5cbiAgICAgIEBhdHRyLmxvbmdpdHVkZSA9IEBtYXBDZW50ZXIoKS5sbmcoKVxuXG4gICAgQHNvdXRoV2VzdExhdGl0dWRlID0gLT5cbiAgICAgIEBhdHRyLmdNYXAuZ2V0Qm91bmRzKCkuZ2V0U291dGhXZXN0KCkubGF0KClcblxuICAgIEBzb3V0aFdlc3RMb25naXR1ZGUgPSAtPlxuICAgICAgQGF0dHIuZ01hcC5nZXRCb3VuZHMoKS5nZXRTb3V0aFdlc3QoKS5sbmcoKVxuXG4gICAgQG5vcnRoRWFzdExhdGl0dWRlID0gLT5cbiAgICAgIEBhdHRyLmdNYXAuZ2V0Qm91bmRzKCkuZ2V0Tm9ydGhFYXN0KCkubGF0KClcblxuICAgIEBub3J0aEVhc3RMb25naXR1ZGUgPSAtPlxuICAgICAgQGF0dHIuZ01hcC5nZXRCb3VuZHMoKS5nZXROb3J0aEVhc3QoKS5sbmcoKVxuXG4gICAgQHJhZGl1cyA9IC0+XG4gICAgICBnQm91bmRzID0gQGF0dHIuZ01hcC5nZXRCb3VuZHMoKVxuICAgICAgc291dGhXZXN0ID0gZ0JvdW5kcy5nZXRTb3V0aFdlc3QoKVxuICAgICAgd2VzdCA9IG5ldyBnb29nbGUubWFwcy5MYXRMbmcoQGxhdGl0dWRlKCksIHNvdXRoV2VzdC5sbmcoKSlcbiAgICAgIHNvdXRoID0gbmV3IGdvb2dsZS5tYXBzLkxhdExuZyhzb3V0aFdlc3QubGF0KCksIEBsb25naXR1ZGUoKSlcbiAgICAgIGxvbmdpdHVkaW5hbERpc3RhbmNlID0gZ29vZ2xlLm1hcHMuZ2VvbWV0cnkuc3BoZXJpY2FsLmNvbXB1dGVEaXN0YW5jZUJldHdlZW4od2VzdCwgQG1hcENlbnRlcigpKVxuICAgICAgbGF0aXR1ZGluYWxEaXN0YW5jZSA9IGdvb2dsZS5tYXBzLmdlb21ldHJ5LnNwaGVyaWNhbC5jb21wdXRlRGlzdGFuY2VCZXR3ZWVuKHNvdXRoLCBAbWFwQ2VudGVyKCkpXG4gICAgICByYWRpdXNJbk1ldGVycyA9IE1hdGgubWF4KGxvbmdpdHVkaW5hbERpc3RhbmNlLCBsYXRpdHVkaW5hbERpc3RhbmNlKVxuXG4gICAgQG1hcENlbnRlciA9IC0+XG4gICAgICBnTGF0TG5nID0gQGF0dHIuZ01hcC5nZXRDZW50ZXIoKVxuXG4gICAgQGFkZEN1c3RvbU1hcmtlciA9IC0+XG4gICAgICBAY3VzdG9tTWFya2VyRGlhbG9nQ2xvc2UoKVxuXG4gICAgQGN1c3RvbU1hcmtlckRpYWxvZ0Nsb3NlID0gLT5cbiAgICAgICQoJyNwaW5fc2VhcmNoX2NvbnRyb2xzIGEuaWNvbl9jbG9zZScpLmNsaWNrID0+XG4gICAgICAgICQoJyNwaW5fc2VhcmNoX2NvbnRyb2xzJykucmVtb3ZlKClcblxuICAgIEBtYXBSZW5kZXJlZEZpcnN0RGF0YSA9IC0+XG4gICAgICBkYXRhID0gQG1hcENoYW5nZWREYXRhKClcbiAgICAgIGRhdGEuemlwID0gQGdlb0RhdGEoKS56aXBcbiAgICAgIGRhdGEuY2l0eSA9IEBnZW9EYXRhKCkuY2l0eVxuICAgICAgZGF0YS5zdGF0ZSA9IEBnZW9EYXRhKCkuc3RhdGVcbiAgICAgIGRhdGEuaG9vZCA9IEBnZW9EYXRhKCkuaG9vZFxuICAgICAgZGF0YVxuXG4gICAgQG1hcENoYW5nZWREYXRhID0gLT5cbiAgICAgIGRhdGEgPSBAbWFwQ2hhbmdlZERhdGFCYXNlKClcbiAgICAgIGRhdGEuc29ydCA9ICdkaXN0YW5jZSdcbiAgICAgIGRhdGFcblxuICAgIEBtYXBDaGFuZ2VkRGF0YUJhc2UgPSAtPlxuICAgICAgZ01hcDogQGF0dHIuZ01hcFxuICAgICAgbGF0aXR1ZGU6IG1hcFV0aWxzLmxpbWl0U2NhbGVPZihAbGF0aXR1ZGUoKSlcbiAgICAgIGxvbmdpdHVkZTogbWFwVXRpbHMubGltaXRTY2FsZU9mKEBsb25naXR1ZGUoKSlcbiAgICAgIHJhZGl1czogQHJhZGl1cygpXG4gICAgICBsYXQxOiBtYXBVdGlscy5saW1pdFNjYWxlT2YoQHNvdXRoV2VzdExhdGl0dWRlKCkpXG4gICAgICBsbmcxOiBtYXBVdGlscy5saW1pdFNjYWxlT2YoQHNvdXRoV2VzdExvbmdpdHVkZSgpKVxuICAgICAgbGF0MjogbWFwVXRpbHMubGltaXRTY2FsZU9mKEBub3J0aEVhc3RMYXRpdHVkZSgpKVxuICAgICAgbG5nMjogbWFwVXRpbHMubGltaXRTY2FsZU9mKEBub3J0aEVhc3RMb25naXR1ZGUoKSlcbiAgICAgIHppcDogQGdlb0RhdGEoKS56aXBcbiAgICAgIGNpdHk6IEBnZW9EYXRhKCkuY2l0eVxuICAgICAgc3RhdGU6IEBnZW9EYXRhKCkuc3RhdGVcbiAgICAgIGhvb2Q6IEBnZW9EYXRhKCkuaG9vZFxuICAgICAgaG9vZERpc3BsYXlOYW1lOiBAZ2VvRGF0YSgpLmhvb2RfZGlzcGxheV9uYW1lXG5cbiAgICBAem9vbUNpcmNsZSA9IC0+XG4gICAgICByYWRpdXMgPSBkaXN0YW5jZUNvbnZlcnNpb24uY29udmVydE1pbGVzVG9NZXRlcnMoQGdlb0RhdGFSYWRpdXNNaWxlcygpKVxuICAgICAgY2lyY2xlT3B0aW9ucyA9XG4gICAgICAgIGNlbnRlcjogQG1hcENlbnRlcigpXG4gICAgICAgIG1hcDogQGF0dHIuZ01hcFxuICAgICAgICByYWRpdXM6IHJhZGl1c1xuICAgICAgICBmaWxsT3BhY2l0eTogMC4wXG4gICAgICAgIHN0cm9rZU9wYWNpdHk6IDAuMFxuICAgICAgY2lyY2xlID0gbmV3IGdvb2dsZS5tYXBzLkNpcmNsZShjaXJjbGVPcHRpb25zKVxuXG4gICAgQGdlb0RhdGFSYWRpdXNNaWxlcyA9IC0+XG4gICAgICBAZ2VvRGF0YSgpLnJhZCB8fCAxMFxuXG4gICAgQGdlb0RhdGEgPSAtPlxuICAgICAgQGF0dHIuZ2VvRGF0YSB8fCB7fVxuXG4gICAgQGdldEluaXRpYWxHZW8gPSAtPlxuICAgICAgbGF0OiBAZGF0YS5sYXQgfHwgQGRhdGEubGF0aXR1ZGUgfHwgQGF0dHIubGF0aXR1ZGVcbiAgICAgIGxuZzogQGRhdGEubG5nIHx8IEBkYXRhLmxvbmdpdHVkZSB8fCBAYXR0ci5sb25naXR1ZGVcblxuXG4gIHJldHVybiBkZWZpbmVDb21wb25lbnQoZGVmYXVsdE1hcClcbiJdfQ==