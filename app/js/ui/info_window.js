'use strict';
define(['jquery', 'flight/lib/component'], function($, defineComponent) {
  var infoWindow;
  infoWindow = function() {
    ({
      currentOpenWindow: null,
      eventsWired: false
    });
    this.defaultAttrs({
      gMap: {},
      gMarker: {}
    });
    this.showInfoWindowOnMarkerClick = function(ev, data) {
      this.attr.gMarker = data.gMarker;
      this.attr.gMap = data.gMap;
      return this.trigger(document, 'uiInfoWindowDataRequest', {
        listingId: this.attr.gMarker.datumId
      });
    };
    this.render = function(ev, data) {
      this.closeOpenInfoWindow();
      this.openInfoWindow(data);
      return this.wireUpEvents();
    };
    this.closeOpenInfoWindow = function() {
      if (this.currentOpenWindow) {
        return this.currentOpenWindow.close();
      }
    };
    this.openInfoWindow = function(data) {
      if (this.currentOpenWindow == null) {
        this.currentOpenWindow = new google.maps.InfoWindow();
      }
      this.currentOpenWindow.setContent(data);
      return this.currentOpenWindow.open(this.attr.gMap, this.attr.gMarker);
    };
    this.wireUpEvents = function() {
      if (this.currentOpenWindow) {
        google.maps.event.addListenerOnce(this.currentOpenWindow, 'closeclick', function() {
          return $(document).trigger('uiInfoWindowClosed');
        });
        return google.maps.event.addListenerOnce(this.currentOpenWindow, 'domready', (function(_this) {
          return function() {
            return $(document).trigger('uiInfoWindowRendered', {
              listingId: _this.attr.gMarker.datumId,
              marker: _this.attr.gMarker,
              infoWindow: _this.currentOpenWindow
            });
          };
        })(this));
      }
    };
    return this.after('initialize', function() {
      this.on(document, 'markerClicked', this.showInfoWindowOnMarkerClick);
      this.on(document, 'infoWindowDataAvailable', this.render);
      return this.on(document, 'uiCloseOpenInfoWindows', this.closeOpenInfoWindow);
    });
  };
  return infoWindow;
});

//# sourceMappingURL=data:application/json;base64,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Y0FBa0MsTUFBQSxFQUFRLEtBQUMsQ0FBQSxJQUFJLENBQUMsT0FBaEQ7QUFBQSxjQUF5RCxVQUFBLEVBQVksS0FBQyxDQUFBLGlCQUF0RTthQUE1QyxFQURnRTtVQUFBLEVBQUE7UUFBQSxDQUFBLENBQUEsQ0FBQSxJQUFBLENBQWxFLEVBSEY7T0FEYztJQUFBLENBekJoQixDQUFBO1dBZ0NBLElBQUMsQ0FBQSxLQUFELENBQU8sWUFBUCxFQUFxQixTQUFBLEdBQUE7QUFDbkIsTUFBQSxJQUFDLENBQUEsRUFBRCxDQUFJLFFBQUosRUFBYyxlQUFkLEVBQStCLElBQUMsQ0FBQSwyQkFBaEMsQ0FBQSxDQUFBO0FBQUEsTUFDQSxJQUFDLENBQUEsRUFBRCxDQUFJLFFBQUosRUFBYyx5QkFBZCxFQUF5QyxJQUFDLENBQUEsTUFBMUMsQ0FEQSxDQUFBO2FBRUEsSUFBQyxDQUFBLEVBQUQsQ0FBSSxRQUFKLEVBQWMsd0JBQWQsRUFBd0MsSUFBQyxDQUFBLG1CQUF6QyxFQUhtQjtJQUFBLENBQXJCLEVBbENXO0VBQUEsQ0FBYixDQUFBO0FBdUNBLFNBQU8sVUFBUCxDQTVDQztBQUFBLENBSEgsQ0FGQSxDQUFBIiwiZmlsZSI6InVpL2luZm9fd2luZG93LmpzIiwic291cmNlUm9vdCI6Ii9zb3VyY2UvIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnXG5cbmRlZmluZSBbXG4gICdqcXVlcnknXG4gICdmbGlnaHQvbGliL2NvbXBvbmVudCdcbl0sIChcbiAgJFxuICBkZWZpbmVDb21wb25lbnRcbikgLT5cblxuICBpbmZvV2luZG93ID0gLT5cblxuICAgIGN1cnJlbnRPcGVuV2luZG93OiBudWxsXG4gICAgZXZlbnRzV2lyZWQ6IGZhbHNlXG5cbiAgICBAZGVmYXVsdEF0dHJzXG4gICAgICBnTWFwOiB7fVxuICAgICAgZ01hcmtlcjoge31cblxuICAgIEBzaG93SW5mb1dpbmRvd09uTWFya2VyQ2xpY2sgPSAoZXYsIGRhdGEpIC0+XG4gICAgICBAYXR0ci5nTWFya2VyID0gZGF0YS5nTWFya2VyXG4gICAgICBAYXR0ci5nTWFwID0gZGF0YS5nTWFwXG4gICAgICBAdHJpZ2dlciBkb2N1bWVudCwgJ3VpSW5mb1dpbmRvd0RhdGFSZXF1ZXN0JywgbGlzdGluZ0lkOiBAYXR0ci5nTWFya2VyLmRhdHVtSWRcblxuICAgIEByZW5kZXIgPSAoZXYsIGRhdGEpIC0+XG4gICAgICBAY2xvc2VPcGVuSW5mb1dpbmRvdygpXG4gICAgICBAb3BlbkluZm9XaW5kb3coZGF0YSlcbiAgICAgIEB3aXJlVXBFdmVudHMoKVxuXG4gICAgQGNsb3NlT3BlbkluZm9XaW5kb3cgPSAtPlxuICAgICAgQGN1cnJlbnRPcGVuV2luZG93LmNsb3NlKCkgaWYgQGN1cnJlbnRPcGVuV2luZG93XG5cbiAgICBAb3BlbkluZm9XaW5kb3cgPSAoZGF0YSkgLT5cbiAgICAgIEBjdXJyZW50T3BlbldpbmRvdyA/PSBuZXcgZ29vZ2xlLm1hcHMuSW5mb1dpbmRvdygpXG4gICAgICBAY3VycmVudE9wZW5XaW5kb3cuc2V0Q29udGVudCBkYXRhXG4gICAgICBAY3VycmVudE9wZW5XaW5kb3cub3BlbiBAYXR0ci5nTWFwLCBAYXR0ci5nTWFya2VyXG5cbiAgICBAd2lyZVVwRXZlbnRzID0gLT5cbiAgICAgIGlmIEBjdXJyZW50T3BlbldpbmRvd1xuICAgICAgICBnb29nbGUubWFwcy5ldmVudC5hZGRMaXN0ZW5lck9uY2UgQGN1cnJlbnRPcGVuV2luZG93LCAnY2xvc2VjbGljaycsIC0+XG4gICAgICAgICAgJChkb2N1bWVudCkudHJpZ2dlciAndWlJbmZvV2luZG93Q2xvc2VkJ1xuICAgICAgICBnb29nbGUubWFwcy5ldmVudC5hZGRMaXN0ZW5lck9uY2UgQGN1cnJlbnRPcGVuV2luZG93LCAnZG9tcmVhZHknLCA9PlxuICAgICAgICAgICQoZG9jdW1lbnQpLnRyaWdnZXIgJ3VpSW5mb1dpbmRvd1JlbmRlcmVkJywgbGlzdGluZ0lkOiBAYXR0ci5nTWFya2VyLmRhdHVtSWQsIG1hcmtlcjogQGF0dHIuZ01hcmtlciwgaW5mb1dpbmRvdzogQGN1cnJlbnRPcGVuV2luZG93XG5cbiAgICBAYWZ0ZXIgJ2luaXRpYWxpemUnLCAtPlxuICAgICAgQG9uIGRvY3VtZW50LCAnbWFya2VyQ2xpY2tlZCcsIEBzaG93SW5mb1dpbmRvd09uTWFya2VyQ2xpY2tcbiAgICAgIEBvbiBkb2N1bWVudCwgJ2luZm9XaW5kb3dEYXRhQXZhaWxhYmxlJywgQHJlbmRlclxuICAgICAgQG9uIGRvY3VtZW50LCAndWlDbG9zZU9wZW5JbmZvV2luZG93cycsIEBjbG9zZU9wZW5JbmZvV2luZG93XG5cbiAgcmV0dXJuIGluZm9XaW5kb3dcbiJdfQ==